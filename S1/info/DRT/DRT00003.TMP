1
[G:\Documents and Settings\Admin\Мои документы\Drakon\D2O\TuringCoatWnd.drt] При закрытии программы
19
2 -1 299 -691 679 -481
2 -1 375 -817 698 -725
2 -1 375 -950 698 -858
2 -1 71 -957 337 -858
2 -1 71 -805 337 -706
1 -1 -348 -962 33 -938
2 -1 -347 -450 -5 223
2 -1 375 -437 717 -331
2 -1 -5 -266 375 -67
2 -1 71 -437 299 -305
2 -1 -290 304 147 396
2 -1 375 -286 907 287
2 -1 53 -646 242 -554
2 -1 -24 0 337 241
1 -1 -347 -925 52 -861
1 -1 -347 -843 -176 -753
1 -1 -347 -742 -81 -588
1 -1 -347 -576 -176 -526
3 99 793 -957 1572 -161
0 1 0 0 413 -656 -76 -9 76 9 0 1 0 0 3 2 -1 0
Cleanup
1 1 0 0 413 -490 -38 -9 38 9 0 0 0 0 -1 -1 -1 0
Конец
2 1 0 0 413 -560 -114 -42 114 42 0 1 0 0 -1 1 -1 0
NEW(die);,"msg.ext := die;","msg.msgType := WMMessages.MsgExt;","m := WM.GetDefaultManager();",m.Broadcast(msg);,"AWAIT(nofWindows = 0);"
20 1 0 0 603 -656 -95 -35 76 35 0 0 0 0 -1 -1 -1 0
VAR,"  die : KillerMsg;","  msg : WMMessages.Message;","  m : WM.WindowManager;",{EXCLUSIVE}
0 1 0 0 451 -808 -76 -9 76 9 0 1 0 0 147 6 -1 1
DecCount
1 1 0 0 451 -734 -38 -9 38 9 0 0 0 0 -1 -1 -1 1
Конец
2 1 0 0 451 -771 -76 -9 76 9 0 1 0 0 -1 5 -1 1
DEC(nofWindows);
0 1 0 0 451 -941 -76 -9 76 9 0 1 0 0 148 9 -1 2
IncCount
1 1 0 0 451 -867 -38 -9 38 9 0 0 0 0 -1 -1 -1 2
Конец
2 1 0 0 451 -904 -76 -9 76 9 0 1 0 0 -1 8 -1 2
INC(nofWindows);
0 1 0 0 147 -941 -76 -9 76 9 0 1 0 0 13 12 -1 3
Open*
1 1 0 0 147 -867 -38 -9 38 9 0 0 0 0 -1 -1 -1 3
Конец
2 1 0 0 147 -904 -76 -9 76 9 0 1 0 0 -1 11 -1 3
"NEW(window, FALSE);"
20 1 0 0 261 -941 -19 -16 76 16 0 0 0 0 -1 -1 -1 3
VAR,"  window : TCW;"
0 1 0 0 147 -789 -76 -9 76 9 0 1 0 0 17 16 -1 4
OpenAlpha*
1 1 0 0 147 -715 -38 -9 38 9 0 0 0 0 -1 -1 -1 4
Конец
2 1 0 0 147 -752 -76 -9 76 9 0 1 0 0 -1 15 -1 4
"NEW(window, TRUE);"
20 1 0 0 261 -789 -19 -16 76 16 0 0 0 0 -1 -1 -1 4
VAR,"  window : TCW;"
9 1 0 0 584 -950 -932 -12 -551 12 0 0 0 0 -1 -1 -1 5
"(** Soren Renner / TF *)"
0 1 0 0 -214 -428 -76 -9 76 9 0 1 0 0 22 21 -1 6
TCW.&New
1 1 0 0 -214 214 -38 -9 38 9 0 0 0 0 -1 -1 -1 6
Конец
2 1 0 0 -214 -345 -133 -42 133 42 0 1 0 0 -1 24 -1 6
"Init(WindowWidth, WindowHeight, alpha);","SELF.alpha := alpha;","manager := WM.GetDefaultManager();","manager.Add(100, 100, SELF, {WM.FlagFrame});","SetTitle(Utilities.NewString(""Turing""));",NEW(random);
20 1 0 0 -81 -428 -38 -22 76 22 0 0 0 0 -1 -1 -1 6
"(alpha : BOOLEAN);",VAR,"  i, j : LONGINT;"
2 1 0 0 -214 177 -76 -9 76 9 0 1 0 0 -1 20 -1 6
IncCount;
14 1 0 0 -214 -275 -76 -9 76 9 0 1 0 0 -1 26 -1 6
"i := 0 TO m - 1"
15 1 0 0 -214 -101 -76 -9 76 9 0 1 0 0 -1 29 -1 6
i
14 1 0 0 -214 -238 -76 -9 76 9 0 1 0 0 -1 28 -1 6
"j := 0 TO m - 1"
15 1 0 0 -214 -138 -76 -9 76 9 0 1 0 0 -1 25 -1 6
j
2 1 0 0 -214 -188 -76 -22 76 22 0 1 0 0 -1 27 -1 6
"mesh1[i, j] := 0;","mesh2[i, j] := 0;","n1[i, j] := 0;"
14 1 0 0 -214 -64 -76 -9 76 9 0 1 0 0 -1 31 -1 6
"i := 1 TO m - 2"
15 1 0 0 -214 140 -76 -9 76 9 0 1 0 0 -1 23 -1 6
i
14 1 0 0 -214 -27 -76 -9 76 9 0 1 0 0 -1 33 -1 6
"j := 1 TO m - 2"
15 1 0 0 -214 103 -76 -9 76 9 0 1 0 0 -1 30 -1 6
j
6 1 0 0 -214 10 -76 -9 76 9 0 1 1 0 34 37 -1 6
"random.Dice(100) > 90"
21 1 0 0 -81 10 0 0 0 0 0 1 0 0 -1 35 -1 6
///-34
21 1 0 0 -81 75 0 0 0 0 0 0 0 0 -1 -1 -1 6
///-35
21 1 0 0 -214 75 0 0 0 0 0 1 0 0 35 32 -1 6
///-36
2 1 0 0 -214 47 -114 -9 114 9 0 1 0 0 -1 36 -1 6
"mesh1[i, j] := random.Dice(1000) / 1000;"
0 1 0 0 451 -428 -76 -9 76 9 0 1 0 0 41 40 -1 7
TCW.Resizing
1 1 0 0 451 -340 -38 -9 38 9 0 0 0 0 -1 -1 -1 7
Конец
2 1 0 0 451 -384 -76 -16 76 16 0 1 0 0 -1 39 -1 7
"width := WindowWidth;","height := WindowHeight;"
20 1 0 0 641 -428 -95 -9 76 9 0 0 0 0 -1 -1 -1 7
"(VAR width, height : LONGINT);"
0 1 0 0 109 -257 -76 -9 76 9 0 1 0 0 44 45 -1 8
TCW.Handle
1 1 0 0 109 -76 -38 -9 38 9 0 0 0 0 -1 -1 -1 8
Конец
20 1 0 0 299 -257 -95 -9 76 9 0 0 0 0 -1 -1 -1 8
"(VAR m: WMMessages.Message);"
6 1 0 0 109 -213 -114 -16 114 16 0 1 1 0 46 50 -1 8
"(m.msgType = WMMessages.MsgExt) &","(m.ext # NIL) & (m.ext IS KillerMsg)"
21 1 0 0 242 -213 0 0 0 0 0 1 0 0 -1 49 -1 8
///-46
21 1 0 0 242 -104 0 0 0 0 0 0 0 0 -1 -1 -1 8
///-47
21 1 0 0 109 -104 0 0 0 0 0 1 0 0 47 43 -1 8
///-48
2 1 0 0 242 -132 -76 -9 76 9 0 1 0 0 -1 47 -1 8
Handle^(m);
2 1 0 0 109 -169 -76 -9 76 9 0 1 0 0 -1 48 -1 8
Close;
0 1 0 0 185 -428 -76 -9 76 9 0 1 0 0 -1 53 -1 9
TCW.Close
1 1 0 0 185 -314 -38 -9 38 9 0 0 0 0 -1 -1 -1 9
Конец
2 1 0 0 185 -371 -114 -29 114 29 0 1 0 0 -1 52 -1 9
"alive := FALSE;","BEGIN {EXCLUSIVE} AWAIT(dead) END;",Close^;,DecCount;
0 1 0 0 -214 313 -76 -9 76 9 0 1 0 0 57 56 -1 10
TCW.Draw*
1 1 0 0 -214 387 -38 -9 38 9 0 0 0 0 -1 -1 -1 10
Конец
2 1 0 0 -214 350 -76 -9 76 9 0 1 0 0 -1 55 -1 10
"Draw^(canvas, w, h, 0);"
20 1 0 0 71 313 -190 -9 76 9 0 0 0 0 -1 -1 -1 10
"(canvas : WMGraphics.Canvas; w, h, q : LONGINT);"
0 1 0 0 546 -257 -76 -9 76 9 0 1 0 0 60 62 -1 11
TCW.DrawIt
1 1 0 0 546 278 -38 -9 38 9 0 0 0 0 -1 -1 -1 11
Конец
20 1 0 0 679 -257 -38 -29 76 29 0 0 0 0 -1 -1 -1 11
VAR,"  i, j, ix, jy : LONGINT;","  pix : Raster.Pixel;","  mode : Raster.Mode;"
2 1 0 0 546 241 -171 -9 171 9 0 1 0 0 -1 59 -1 11
"Invalidate(WMRectangles.MakeRect(0, 0, GetWidth(), GetHeight()));"
2 1 0 0 546 -200 -114 -9 114 9 0 1 0 0 -1 63 -1 11
"Raster.InitMode(mode, Raster.srcCopy);"
14 1 0 0 546 -163 -76 -9 76 9 0 1 0 0 -1 65 -1 11
"i := 0 TO m - 1"
15 1 0 0 546 204 -76 -9 76 9 0 1 0 0 -1 61 -1 11
i
2 1 0 0 546 -126 -76 -9 76 9 0 1 0 0 -1 66 -1 11
"ix := i * size;"
14 1 0 0 546 -89 -76 -9 76 9 0 1 0 0 -1 68 -1 11
"j := 0 TO m - 1"
15 1 0 0 546 167 -76 -9 76 9 0 1 0 0 -1 64 -1 11
j
2 1 0 0 546 -52 -76 -9 76 9 0 1 0 0 -1 70 -1 11
"jy := j * size;"
2 1 0 0 546 130 -133 -9 133 9 0 1 0 0 -1 67 -1 11
"Raster.Fill(img, ix, jy, ix+size, jy+size, pix, mode);"
6 1 0 0 546 -15 -76 -9 76 9 0 1 1 0 71 74 -1 11
alpha
21 1 0 0 793 -15 0 0 0 0 0 1 0 0 -1 75 -1 11
///-71
21 1 0 0 793 102 0 0 0 0 0 0 0 0 -1 -1 -1 11
///-72
21 1 0 0 546 102 0 0 0 0 0 1 0 0 72 69 -1 11
///-73
2 1 0 0 546 48 -114 -35 114 35 0 1 0 0 -1 73 -1 11
"Raster.SetRGBA(pix,","  SHORT((255 - ENTIER(mesh1[i, j] * 255))),","  SHORT((255 - ENTIER(mesh2[i, j] * 255))), 0, ","  SHORT((255 - ENTIER(mesh2[i, j] * 255)) +","  ENTIER(mesh1[i, j] * 255)) MOD 128 + 127);"
2 1 0 0 793 26 -114 -22 114 22 0 1 0 0 -1 72 -1 11
"Raster.SetRGB(pix,","  SHORT((255 - ENTIER(mesh1[i, j] * 255))),","  SHORT((255 - ENTIER(mesh2[i, j] * 255))), 0);"
0 1 0 0 147 -637 -76 -9 76 9 0 1 0 0 -1 78 -1 12
BEGIN
1 1 0 0 147 -563 -38 -9 38 9 0 0 0 0 -1 -1 -1 12
Конец
2 1 0 0 147 -600 -94 -9 95 9 0 1 0 0 -1 77 -1 12
Modules.InstallTermHandler(Cleanup);
0 1 0 0 90 9 -76 -9 76 9 0 1 0 0 146 81 -1 13
TCW.BEGIN
1 1 0 0 90 232 -38 -9 38 9 0 0 0 0 -1 -1 -1 13
Конец
2 1 0 0 90 53 -95 -16 95 16 0 1 0 0 -1 82 -1 13
"alive := TRUE;",Objects.SetPriority(Objects.Low);
21 1 0 0 90 88 0 0 0 0 0 1 0 3 83 85 -1 13
///-82
21 1 0 0 280 88 0 0 0 0 0 0 0 0 -1 92 -1 13
///-83
21 1 0 0 223 116 0 0 0 0 0 1 0 0 -1 93 -1 13
///-84
6 1 0 0 90 116 -38 -9 38 9 0 1 0 0 84 86 -1 13
alive
2 1 0 0 90 195 -114 -9 114 9 0 1 0 0 -1 80 -1 13
"BEGIN {EXCLUSIVE} dead := TRUE END;"
9 1 0 0 -195 -893 -152 -32 247 32 0 0 0 0 -1 -1 -1 14
IMPORT,,"  Raster, AosRandom := Random, Objects, WMRectangles, WMGraphics, Modules,","  Utilities := Strings, WM := WMWindowManager, WMMessages;"
9 1 0 0 -176 -798 -171 -45 0 45 0 0 0 0 -1 -1 -1 15
CONST,,"  m = 50;","  size = 4;","  WindowWidth = m * size;","  WindowHeight = m * size; "
9 1 0 0 -195 -665 -152 -77 114 77 0 0 0 0 -1 -1 -1 16
TYPE,,"  KillerMsg = OBJECT","  END KillerMsg;  ",,"  TCW* = OBJECT(WM.BufferWindow)","  VAR","    mesh1, mesh2, n1 : ARRAY m, m OF REAL;","    random : AosRandom.Generator;","    alive, dead, alpha : BOOLEAN;","  END TCW;"
9 1 0 0 -157 -551 -190 -25 -19 25 0 0 0 0 -1 -1 -1 17
VAR,,"  nofWindows : LONGINT;"
21 1 0 0 223 186 0 0 0 0 0 0 0 0 92 -1 -1 13
///-91
21 1 0 0 280 186 0 0 0 0 0 0 0 0 -1 -1 -1 13
///-92
2 1 0 0 223 151 -38 -16 38 16 0 1 0 0 -1 91 -1 13
Generation;,DrawIt;
0 1 0 0 907 -941 -76 -9 76 9 0 0 0 0 104 95 -1 18
TCW.Generation
21 1 0 0 907 -906 0 0 0 0 0 0 0 1 115 96 -1 18
///-95
4 1 0 0 907 -868 -95 -19 95 19 0 1 0 0 -1 105 94 18
///-96
5 1 0 0 907 -197 -95 -19 95 17 0 0 0 0 -1 98 116 18
116
21 1 0 0 907 -161 0 0 0 0 0 0 0 0 118 -1 -1 18
///-98
21 1 0 0 793 -161 0 0 0 0 0 0 0 0 98 -1 -1 18
///-99
21 1 0 0 793 -906 0 0 0 0 0 0 0 0 95 99 -1 18
///-100
21 1 0 0 1306 -906 0 0 0 0 0 0 0 0 -1 102 -1 18
///-101
4 1 0 0 1306 -868 -114 -19 114 19 0 1 0 0 -1 111 117 18
///-102
1 1 0 0 1306 -247 -38 -9 38 9 0 0 0 0 -1 -1 -1 18
Конец
20 1 0 0 1021 -941 -19 -16 76 16 0 0 0 0 -1 -1 -1 18
VAR,"  i, j : LONGINT;"
14 1 0 0 907 -821 -76 -9 76 9 0 1 0 0 -1 107 -1 18
"i := 1 TO m - 2"
15 1 0 0 907 -551 -76 -9 76 9 0 1 0 0 -1 108 -1 18
i
2 1 0 0 907 -686 -94 -107 95 107 0 1 0 0 -1 106 -1 18
"n1[i, 0] := mesh1[i - 1, 0] +","  mesh1[i + 1, 0] +","  mesh1[i, m - 1] +","  mesh1[i, 1] +","  mesh1[i - 1, m - 1] +","  mesh1[i + 1, 1] +","  mesh1[i + 1, m - 1] +","  mesh1[i - 1,  1];","n1[i, m - 1] := mesh1[i - 1, m - 1] +","  mesh1[i + 1, m - 1] +","  mesh1[i, m - 2] +","  mesh1[i, 0] +","  mesh1[i - 1, m - 2] +","  mesh1[i + 1, 0] +","  mesh1[i + 1, m - 2] +","  mesh1[i - 1, 0];"
14 1 0 0 907 -514 -76 -9 76 9 0 1 0 0 -1 110 -1 18
"j := 1 TO m - 2"
15 1 0 0 907 -244 -76 -9 76 9 0 1 0 0 -1 97 -1 18
j
2 1 0 0 907 -379 -95 -107 95 107 0 1 0 0 -1 109 -1 18
"n1[0, j] := mesh1[m - 1, j] +","  mesh1[1, j] +","  mesh1[0, j - 1] +","  mesh1[0, j + 1] +","  mesh1[m - 1, j - 1] +","  mesh1[1, j + 1] +","  mesh1[1, j - 1] +","  mesh1[m - 1, j + 1];","n1[m - 1, j] := mesh1[m - 2, j] +","  mesh1[0, j] +","  mesh1[m - 1, j - 1] +","  mesh1[m - 1, j + 1] +","  mesh1[m - 2, j - 1] +","  mesh1[0, j + 1] +","  mesh1[0, j - 1] +","  mesh1[m - 2, j + 1];"
14 1 0 0 1306 -821 -76 -9 76 9 0 1 0 0 -1 113 -1 18
"i := 1 TO m - 2"
15 1 0 0 1306 -284 -76 -9 76 9 0 1 0 0 -1 103 -1 18
i
14 1 0 0 1306 -784 -76 -9 76 9 0 1 0 0 -1 124 -1 18
"j := 1 TO m - 2"
15 1 0 0 1306 -321 -76 -9 76 9 0 1 0 0 -1 112 -1 18
j
21 1 0 0 1097 -906 0 0 0 0 0 0 0 0 101 116 -1 18
///-115
4 1 0 0 1097 -868 -76 -19 76 19 0 1 0 0 -1 119 97 18
///-116
5 1 0 0 1097 -197 -76 -19 76 17 0 0 0 0 -1 118 102 18
102
21 1 0 0 1097 -161 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-118
14 1 0 0 1097 -821 -76 -9 76 9 0 1 0 0 -1 121 -1 18
"i := 1 TO m - 2"
15 1 0 0 1097 -581 -76 -9 76 9 0 1 0 0 -1 117 -1 18
i
14 1 0 0 1097 -784 -76 -9 76 9 0 1 0 0 -1 123 -1 18
"j := 1 TO m - 2"
15 1 0 0 1097 -618 -76 -9 76 9 0 1 0 0 -1 120 -1 18
j
2 1 0 0 1097 -701 -76 -55 76 55 0 1 0 0 -1 122 -1 18
"n1[i, j] := mesh1[i - 1, j] +","  mesh1[i + 1, j] +","  mesh1[i, j - 1] +","  mesh1[i, j + 1]  +","  mesh1[i - 1, j - 1] +","  mesh1[i + 1, j + 1] +","  mesh1[i + 1, j - 1] +","  mesh1[i - 1, j + 1];"
9 1 0 0 1306 -744 -114 -12 114 12 0 1 0 0 -1 125 -1 18
"HERE ARE THE DIFFERENCE RULES!"
2 1 0 0 1306 -671 -76 -42 76 42 0 1 0 0 -1 126 -1 18
"mesh1[i, j] := mesh1[i, j] +","  n1[i, j] / 80 -","  (mesh2[i, j] * mesh2[i, j]);","mesh2[i, j] := mesh2[i, j] +","  mesh1[i, j] / 20 -","  0.03;"
6 1 0 0 1306 -601 -76 -9 76 9 0 1 1 0 127 134 -1 18
"mesh1[i, j] < 0"
21 1 0 0 1477 -601 0 0 0 0 0 1 0 0 -1 136 -1 18
///-127
21 1 0 0 1477 -489 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-128
21 1 0 0 1306 -489 0 0 0 0 0 1 0 0 128 130 -1 18
///-129
6 1 0 0 1306 -461 -76 -9 76 9 0 1 1 0 131 135 -1 18
"mesh2[i, j] < 0"
21 1 0 0 1477 -461 0 0 0 0 0 1 0 0 -1 140 -1 18
///-131
21 1 0 0 1477 -349 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-132
21 1 0 0 1306 -349 0 0 0 0 0 1 0 0 132 114 -1 18
///-133
2 1 0 0 1306 -564 -76 -9 76 9 0 1 0 0 -1 129 -1 18
"mesh1[i, j] := 0;"
2 1 0 0 1306 -424 -76 -9 76 9 0 1 0 0 -1 133 -1 18
"mesh2[i, j] := 0;"
6 1 0 0 1477 -573 -76 -9 76 9 0 1 1 0 137 144 -1 18
"mesh1[i, j] > 1"
21 1 0 0 1572 -573 0 0 0 0 0 1 0 0 -1 138 -1 18
///-137
21 1 0 0 1572 -508 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-138
21 1 0 0 1477 -508 0 0 0 0 0 1 0 0 138 128 -1 18
///-139
6 1 0 0 1477 -433 -76 -9 76 9 0 1 1 0 141 145 -1 18
"mesh2[i, j] > 1"
21 1 0 0 1572 -433 0 0 0 0 0 1 0 0 -1 142 -1 18
///-141
21 1 0 0 1572 -368 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-142
21 1 0 0 1477 -368 0 0 0 0 0 1 0 0 142 132 -1 18
///-143
2 1 0 0 1477 -536 -76 -9 76 9 0 1 0 0 -1 139 -1 18
"mesh1[i, j] := 1;"
2 1 0 0 1477 -396 -76 -9 76 9 0 1 0 0 -1 143 -1 18
"mesh2[i, j] := 1;"
20 1 0 0 261 9 -76 -9 76 9 0 0 0 0 -1 -1 -1 13
{ACTIVE}
20 1 0 0 622 -808 -76 -9 76 9 0 0 0 0 -1 -1 -1 1
{EXCLUSIVE}
20 1 0 0 622 -941 -76 -9 76 9 0 0 0 0 -1 -1 -1 2
{EXCLUSIVE}
