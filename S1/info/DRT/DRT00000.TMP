1
[G:\Documents and Settings\Admin\Мои документы\Drakon\D2O\TuringCoatWnd.drt] При закрытии программы
19
2 -1 665 297 1045 507
2 -1 741 171 1064 263
2 -1 741 38 1064 130
2 -1 437 31 703 130
2 -1 437 183 703 282
1 -1 18 26 399 50
2 -1 19 538 361 1211
2 -1 741 551 1083 657
2 -1 361 722 741 921
2 -1 437 551 665 683
2 -1 76 1292 513 1384
2 -1 741 702 1273 1275
2 -1 419 342 608 434
2 -1 342 988 703 1229
1 -1 19 63 418 127
1 -1 19 145 190 235
1 -1 19 246 285 400
1 -1 19 412 190 462
3 99 1159 31 1938 827
0 1 0 0 779 332 -76 -9 76 9 0 1 0 0 3 2 -1 0
Cleanup
1 1 0 0 779 498 -38 -9 38 9 0 0 0 0 -1 -1 -1 0
Конец
2 1 0 0 779 428 -114 -42 114 42 0 1 0 0 -1 1 -1 0
NEW(die);,"msg.ext := die;","msg.msgType := WMMessages.MsgExt;","m := WM.GetDefaultManager();",m.Broadcast(msg);,"AWAIT(nofWindows = 0);"
20 1 0 0 969 332 -95 -35 76 35 0 0 0 0 -1 -1 -1 0
VAR,"  die : KillerMsg;","  msg : WMMessages.Message;","  m : WM.WindowManager;",{EXCLUSIVE}
0 1 0 0 817 180 -76 -9 76 9 0 1 0 0 147 6 -1 1
DecCount
1 1 0 0 817 254 -38 -9 38 9 0 0 0 0 -1 -1 -1 1
Конец
2 1 0 0 817 217 -76 -9 76 9 0 1 0 0 -1 5 -1 1
DEC(nofWindows);
0 1 0 0 817 47 -76 -9 76 9 0 1 0 0 148 9 -1 2
IncCount
1 1 0 0 817 121 -38 -9 38 9 0 0 0 0 -1 -1 -1 2
Конец
2 1 0 0 817 84 -76 -9 76 9 0 1 0 0 -1 8 -1 2
INC(nofWindows);
0 1 0 0 513 47 -76 -9 76 9 0 1 0 0 13 12 -1 3
Open*
1 1 0 0 513 121 -38 -9 38 9 0 0 0 0 -1 -1 -1 3
Конец
2 1 0 0 513 84 -76 -9 76 9 0 1 0 0 -1 11 -1 3
"NEW(window, FALSE);"
20 1 0 0 627 47 -19 -16 76 16 0 0 0 0 -1 -1 -1 3
VAR,"  window : TCW;"
0 1 0 0 513 199 -76 -9 76 9 0 1 0 0 17 16 -1 4
OpenAlpha*
1 1 0 0 513 273 -38 -9 38 9 0 0 0 0 -1 -1 -1 4
Конец
2 1 0 0 513 236 -76 -9 76 9 0 1 0 0 -1 15 -1 4
"NEW(window, TRUE);"
20 1 0 0 627 199 -19 -16 76 16 0 0 0 0 -1 -1 -1 4
VAR,"  window : TCW;"
9 1 0 0 950 38 -932 -12 -551 12 0 0 0 0 -1 -1 -1 5
"(** Soren Renner / TF *)"
0 1 0 0 152 560 -76 -9 76 9 0 1 0 0 22 21 -1 6
TCW.&New
1 1 0 0 152 1202 -38 -9 38 9 0 0 0 0 -1 -1 -1 6
Конец
2 1 0 0 152 643 -133 -42 133 42 0 1 0 0 -1 24 -1 6
"Init(WindowWidth, WindowHeight, alpha);","SELF.alpha := alpha;","manager := WM.GetDefaultManager();","manager.Add(100, 100, SELF, {WM.FlagFrame});","SetTitle(Utilities.NewString(""Turing""));",NEW(random);
20 1 0 0 285 560 -38 -22 76 22 0 0 0 0 -1 -1 -1 6
"(alpha : BOOLEAN);",VAR,"  i, j : LONGINT;"
2 1 0 0 152 1165 -76 -9 76 9 0 1 0 0 -1 20 -1 6
IncCount;
14 1 0 0 152 713 -76 -9 76 9 0 1 0 0 -1 26 -1 6
"i := 0 TO m - 1"
15 1 0 0 152 887 -76 -9 76 9 0 1 0 0 -1 29 -1 6
i
14 1 0 0 152 750 -76 -9 76 9 0 1 0 0 -1 28 -1 6
"j := 0 TO m - 1"
15 1 0 0 152 850 -76 -9 76 9 0 1 0 0 -1 25 -1 6
j
2 1 0 0 152 800 -76 -22 76 22 0 1 0 0 -1 27 -1 6
"mesh1[i, j] := 0;","mesh2[i, j] := 0;","n1[i, j] := 0;"
14 1 0 0 152 924 -76 -9 76 9 0 1 0 0 -1 31 -1 6
"i := 1 TO m - 2"
15 1 0 0 152 1128 -76 -9 76 9 0 1 0 0 -1 23 -1 6
i
14 1 0 0 152 961 -76 -9 76 9 0 1 0 0 -1 33 -1 6
"j := 1 TO m - 2"
15 1 0 0 152 1091 -76 -9 76 9 0 1 0 0 -1 30 -1 6
j
6 1 0 0 152 998 -76 -9 76 9 0 1 1 0 34 37 -1 6
"random.Dice(100) > 90"
21 1 0 0 285 998 0 0 0 0 0 1 0 0 -1 35 -1 6
///-34
21 1 0 0 285 1063 0 0 0 0 0 0 0 0 -1 -1 -1 6
///-35
21 1 0 0 152 1063 0 0 0 0 0 1 0 0 35 32 -1 6
///-36
2 1 0 0 152 1035 -114 -9 114 9 0 1 0 0 -1 36 -1 6
"mesh1[i, j] := random.Dice(1000) / 1000;"
0 1 0 0 817 560 -76 -9 76 9 0 1 0 0 41 40 -1 7
TCW.Resizing
1 1 0 0 817 648 -38 -9 38 9 0 0 0 0 -1 -1 -1 7
Конец
2 1 0 0 817 604 -76 -16 76 16 0 1 0 0 -1 39 -1 7
"width := WindowWidth;","height := WindowHeight;"
20 1 0 0 1007 560 -95 -9 76 9 0 0 0 0 -1 -1 -1 7
"(VAR width, height : LONGINT);"
0 1 0 0 475 731 -76 -9 76 9 0 1 0 0 44 45 -1 8
TCW.Handle
1 1 0 0 475 912 -38 -9 38 9 0 0 0 0 -1 -1 -1 8
Конец
20 1 0 0 665 731 -95 -9 76 9 0 0 0 0 -1 -1 -1 8
"(VAR m: WMMessages.Message);"
6 1 0 0 475 775 -114 -16 114 16 0 1 1 0 46 50 -1 8
"(m.msgType = WMMessages.MsgExt) &","(m.ext # NIL) & (m.ext IS KillerMsg)"
21 1 0 0 608 775 0 0 0 0 0 1 0 0 -1 49 -1 8
///-46
21 1 0 0 608 884 0 0 0 0 0 0 0 0 -1 -1 -1 8
///-47
21 1 0 0 475 884 0 0 0 0 0 1 0 0 47 43 -1 8
///-48
2 1 0 0 608 856 -76 -9 76 9 0 1 0 0 -1 47 -1 8
Handle^(m);
2 1 0 0 475 819 -76 -9 76 9 0 1 0 0 -1 48 -1 8
Close;
0 1 0 0 551 560 -76 -9 76 9 0 1 0 0 -1 53 -1 9
TCW.Close
1 1 0 0 551 674 -38 -9 38 9 0 0 0 0 -1 -1 -1 9
Конец
2 1 0 0 551 617 -114 -29 114 29 0 1 0 0 -1 52 -1 9
"alive := FALSE;","BEGIN {EXCLUSIVE} AWAIT(dead) END;",Close^;,DecCount;
0 1 0 0 152 1301 -76 -9 76 9 0 1 0 0 57 56 -1 10
TCW.Draw*
1 1 0 0 152 1375 -38 -9 38 9 0 0 0 0 -1 -1 -1 10
Конец
2 1 0 0 152 1338 -76 -9 76 9 0 1 0 0 -1 55 -1 10
"Draw^(canvas, w, h, 0);"
20 1 0 0 437 1301 -190 -9 76 9 0 0 0 0 -1 -1 -1 10
"(canvas : WMGraphics.Canvas; w, h, q : LONGINT);"
0 1 0 0 912 731 -76 -9 76 9 0 1 0 0 60 62 -1 11
TCW.DrawIt
1 1 0 0 912 1266 -38 -9 38 9 0 0 0 0 -1 -1 -1 11
Конец
20 1 0 0 1045 731 -38 -29 76 29 0 0 0 0 -1 -1 -1 11
VAR,"  i, j, ix, jy : LONGINT;","  pix : Raster.Pixel;","  mode : Raster.Mode;"
2 1 0 0 912 1229 -171 -9 171 9 0 1 0 0 -1 59 -1 11
"Invalidate(WMRectangles.MakeRect(0, 0, GetWidth(), GetHeight()));"
2 1 0 0 912 788 -114 -9 114 9 0 1 0 0 -1 63 -1 11
"Raster.InitMode(mode, Raster.srcCopy);"
14 1 0 0 912 825 -76 -9 76 9 0 1 0 0 -1 65 -1 11
"i := 0 TO m - 1"
15 1 0 0 912 1192 -76 -9 76 9 0 1 0 0 -1 61 -1 11
i
2 1 0 0 912 862 -76 -9 76 9 0 1 0 0 -1 66 -1 11
"ix := i * size;"
14 1 0 0 912 899 -76 -9 76 9 0 1 0 0 -1 68 -1 11
"j := 0 TO m - 1"
15 1 0 0 912 1155 -76 -9 76 9 0 1 0 0 -1 64 -1 11
j
2 1 0 0 912 936 -76 -9 76 9 0 1 0 0 -1 70 -1 11
"jy := j * size;"
2 1 0 0 912 1118 -133 -9 133 9 0 1 0 0 -1 67 -1 11
"Raster.Fill(img, ix, jy, ix+size, jy+size, pix, mode);"
6 1 0 0 912 973 -76 -9 76 9 0 1 1 0 71 74 -1 11
alpha
21 1 0 0 1159 973 0 0 0 0 0 1 0 0 -1 75 -1 11
///-71
21 1 0 0 1159 1090 0 0 0 0 0 0 0 0 -1 -1 -1 11
///-72
21 1 0 0 912 1090 0 0 0 0 0 1 0 0 72 69 -1 11
///-73
2 1 0 0 912 1036 -114 -35 114 35 0 1 0 0 -1 73 -1 11
"Raster.SetRGBA(pix,","  SHORT((255 - ENTIER(mesh1[i, j] * 255))),","  SHORT((255 - ENTIER(mesh2[i, j] * 255))), 0, ","  SHORT((255 - ENTIER(mesh2[i, j] * 255)) +","  ENTIER(mesh1[i, j] * 255)) MOD 128 + 127);"
2 1 0 0 1159 1014 -114 -22 114 22 0 1 0 0 -1 72 -1 11
"Raster.SetRGB(pix,","  SHORT((255 - ENTIER(mesh1[i, j] * 255))),","  SHORT((255 - ENTIER(mesh2[i, j] * 255))), 0);"
0 1 0 0 513 351 -76 -9 76 9 0 1 0 0 -1 78 -1 12
BEGIN
1 1 0 0 513 425 -38 -9 38 9 0 0 0 0 -1 -1 -1 12
Конец
2 1 0 0 513 388 -94 -9 95 9 0 1 0 0 -1 77 -1 12
Modules.InstallTermHandler(Cleanup);
0 1 0 0 456 997 -76 -9 76 9 0 1 0 0 146 81 -1 13
TCW.BEGIN
1 1 0 0 456 1220 -38 -9 38 9 0 0 0 0 -1 -1 -1 13
Конец
2 1 0 0 456 1041 -95 -16 95 16 0 1 0 0 -1 82 -1 13
"alive := TRUE;",Objects.SetPriority(Objects.Low);
21 1 0 0 456 1076 0 0 0 0 0 1 0 3 83 85 -1 13
///-82
21 1 0 0 646 1076 0 0 0 0 0 0 0 0 -1 92 -1 13
///-83
21 1 0 0 589 1104 0 0 0 0 0 1 0 0 -1 93 -1 13
///-84
6 1 0 0 456 1104 -38 -9 38 9 0 1 0 0 84 86 -1 13
alive
2 1 0 0 456 1183 -114 -9 114 9 0 1 0 0 -1 80 -1 13
"BEGIN {EXCLUSIVE} dead := TRUE END;"
9 1 0 0 171 95 -152 -32 247 32 0 0 0 0 -1 -1 -1 14
IMPORT,,"  Raster, AosRandom := Random, Objects, WMRectangles, WMGraphics, Modules,","  Utilities := Strings, WM := WMWindowManager, WMMessages;"
9 1 0 0 190 190 -171 -45 0 45 0 0 0 0 -1 -1 -1 15
CONST,,"  m = 50;","  size = 4;","  WindowWidth = m * size;","  WindowHeight = m * size; "
9 1 0 0 171 323 -152 -77 114 77 0 0 0 0 -1 -1 -1 16
TYPE,,"  KillerMsg = OBJECT","  END KillerMsg;  ",,"  TCW* = OBJECT(WM.BufferWindow)","  VAR","    mesh1, mesh2, n1 : ARRAY m, m OF REAL;","    random : AosRandom.Generator;","    alive, dead, alpha : BOOLEAN;","  END TCW;"
9 1 0 0 209 437 -190 -25 -19 25 0 0 0 0 -1 -1 -1 17
VAR,,"  nofWindows : LONGINT;"
21 1 0 0 589 1174 0 0 0 0 0 0 0 0 92 -1 -1 13
///-91
21 1 0 0 646 1174 0 0 0 0 0 0 0 0 -1 -1 -1 13
///-92
2 1 0 0 589 1139 -38 -16 38 16 0 1 0 0 -1 91 -1 13
Generation;,DrawIt;
0 1 0 0 1273 47 -76 -9 76 9 0 0 0 0 104 95 -1 18
TCW.Generation
21 1 0 0 1273 82 0 0 0 0 0 0 0 1 115 96 -1 18
///-95
4 1 0 0 1273 120 -95 -19 95 19 0 1 0 0 -1 105 94 18
///-96
5 1 0 0 1273 791 -95 -19 95 17 0 0 0 0 -1 98 116 18
116
21 1 0 0 1273 827 0 0 0 0 0 0 0 0 118 -1 -1 18
///-98
21 1 0 0 1159 827 0 0 0 0 0 0 0 0 98 -1 -1 18
///-99
21 1 0 0 1159 82 0 0 0 0 0 0 0 0 95 99 -1 18
///-100
21 1 0 0 1672 82 0 0 0 0 0 0 0 0 -1 102 -1 18
///-101
4 1 0 0 1672 120 -114 -19 114 19 0 1 0 0 -1 111 117 18
///-102
1 1 0 0 1672 741 -38 -9 38 9 0 0 0 0 -1 -1 -1 18
Конец
20 1 0 0 1387 47 -19 -16 76 16 0 0 0 0 -1 -1 -1 18
VAR,"  i, j : LONGINT;"
14 1 0 0 1273 167 -76 -9 76 9 0 1 0 0 -1 107 -1 18
"i := 1 TO m - 2"
15 1 0 0 1273 437 -76 -9 76 9 0 1 0 0 -1 108 -1 18
i
2 1 0 0 1273 302 -94 -107 95 107 0 1 0 0 -1 106 -1 18
"n1[i, 0] := mesh1[i - 1, 0] +","  mesh1[i + 1, 0] +","  mesh1[i, m - 1] +","  mesh1[i, 1] +","  mesh1[i - 1, m - 1] +","  mesh1[i + 1, 1] +","  mesh1[i + 1, m - 1] +","  mesh1[i - 1,  1];","n1[i, m - 1] := mesh1[i - 1, m - 1] +","  mesh1[i + 1, m - 1] +","  mesh1[i, m - 2] +","  mesh1[i, 0] +","  mesh1[i - 1, m - 2] +","  mesh1[i + 1, 0] +","  mesh1[i + 1, m - 2] +","  mesh1[i - 1, 0];"
14 1 0 0 1273 474 -76 -9 76 9 0 1 0 0 -1 110 -1 18
"j := 1 TO m - 2"
15 1 0 0 1273 744 -76 -9 76 9 0 1 0 0 -1 97 -1 18
j
2 1 0 0 1273 609 -95 -107 95 107 0 1 0 0 -1 109 -1 18
"n1[0, j] := mesh1[m - 1, j] +","  mesh1[1, j] +","  mesh1[0, j - 1] +","  mesh1[0, j + 1] +","  mesh1[m - 1, j - 1] +","  mesh1[1, j + 1] +","  mesh1[1, j - 1] +","  mesh1[m - 1, j + 1];","n1[m - 1, j] := mesh1[m - 2, j] +","  mesh1[0, j] +","  mesh1[m - 1, j - 1] +","  mesh1[m - 1, j + 1] +","  mesh1[m - 2, j - 1] +","  mesh1[0, j + 1] +","  mesh1[0, j - 1] +","  mesh1[m - 2, j + 1];"
14 1 0 0 1672 167 -76 -9 76 9 0 1 0 0 -1 113 -1 18
"i := 1 TO m - 2"
15 1 0 0 1672 704 -76 -9 76 9 0 1 0 0 -1 103 -1 18
i
14 1 0 0 1672 204 -76 -9 76 9 0 1 0 0 -1 124 -1 18
"j := 1 TO m - 2"
15 1 0 0 1672 667 -76 -9 76 9 0 1 0 0 -1 112 -1 18
j
21 1 0 0 1463 82 0 0 0 0 0 0 0 0 101 116 -1 18
///-115
4 1 0 0 1463 120 -76 -19 76 19 0 1 0 0 -1 119 97 18
///-116
5 1 0 0 1463 791 -76 -19 76 17 0 0 0 0 -1 118 102 18
102
21 1 0 0 1463 827 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-118
14 1 0 0 1463 167 -76 -9 76 9 0 1 0 0 -1 121 -1 18
"i := 1 TO m - 2"
15 1 0 0 1463 407 -76 -9 76 9 0 1 0 0 -1 117 -1 18
i
14 1 0 0 1463 204 -76 -9 76 9 0 1 0 0 -1 123 -1 18
"j := 1 TO m - 2"
15 1 0 0 1463 370 -76 -9 76 9 0 1 0 0 -1 120 -1 18
j
2 1 0 0 1463 287 -76 -55 76 55 0 1 0 0 -1 122 -1 18
"n1[i, j] := mesh1[i - 1, j] +","  mesh1[i + 1, j] +","  mesh1[i, j - 1] +","  mesh1[i, j + 1]  +","  mesh1[i - 1, j - 1] +","  mesh1[i + 1, j + 1] +","  mesh1[i + 1, j - 1] +","  mesh1[i - 1, j + 1];"
9 1 0 0 1672 244 -114 -12 114 12 0 1 0 0 -1 125 -1 18
"HERE ARE THE DIFFERENCE RULES!"
2 1 0 0 1672 317 -76 -42 76 42 0 1 0 0 -1 126 -1 18
"mesh1[i, j] := mesh1[i, j] +","  n1[i, j] / 80 -","  (mesh2[i, j] * mesh2[i, j]);","mesh2[i, j] := mesh2[i, j] +","  mesh1[i, j] / 20 -","  0.03;"
6 1 0 0 1672 387 -76 -9 76 9 0 1 1 0 127 134 -1 18
"mesh1[i, j] < 0"
21 1 0 0 1843 387 0 0 0 0 0 1 0 0 -1 136 -1 18
///-127
21 1 0 0 1843 499 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-128
21 1 0 0 1672 499 0 0 0 0 0 1 0 0 128 130 -1 18
///-129
6 1 0 0 1672 527 -76 -9 76 9 0 1 1 0 131 135 -1 18
"mesh2[i, j] < 0"
21 1 0 0 1843 527 0 0 0 0 0 1 0 0 -1 140 -1 18
///-131
21 1 0 0 1843 639 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-132
21 1 0 0 1672 639 0 0 0 0 0 1 0 0 132 114 -1 18
///-133
2 1 0 0 1672 424 -76 -9 76 9 0 1 0 0 -1 129 -1 18
"mesh1[i, j] := 0;"
2 1 0 0 1672 564 -76 -9 76 9 0 1 0 0 -1 133 -1 18
"mesh2[i, j] := 0;"
6 1 0 0 1843 415 -76 -9 76 9 0 1 1 0 137 144 -1 18
"mesh1[i, j] > 1"
21 1 0 0 1938 415 0 0 0 0 0 1 0 0 -1 138 -1 18
///-137
21 1 0 0 1938 480 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-138
21 1 0 0 1843 480 0 0 0 0 0 1 0 0 138 128 -1 18
///-139
6 1 0 0 1843 555 -76 -9 76 9 0 1 1 0 141 145 -1 18
"mesh2[i, j] > 1"
21 1 0 0 1938 555 0 0 0 0 0 1 0 0 -1 142 -1 18
///-141
21 1 0 0 1938 620 0 0 0 0 0 0 0 0 -1 -1 -1 18
///-142
21 1 0 0 1843 620 0 0 0 0 0 1 0 0 142 132 -1 18
///-143
2 1 0 0 1843 452 -76 -9 76 9 0 1 0 0 -1 139 -1 18
"mesh1[i, j] := 1;"
2 1 0 0 1843 592 -76 -9 76 9 0 1 0 0 -1 143 -1 18
"mesh2[i, j] := 1;"
20 1 0 0 627 997 -76 -9 76 9 0 0 0 0 -1 -1 -1 13
{ACTIVE}
20 1 0 0 988 180 -76 -9 76 9 0 0 0 0 -1 -1 -1 1
{EXCLUSIVE}
20 1 0 0 988 47 -76 -9 76 9 0 0 0 0 -1 -1 -1 2
{EXCLUSIVE}
